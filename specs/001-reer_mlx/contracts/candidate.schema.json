{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://reer-dspy-mlx/schemas/candidate.schema.json",
  "title": "Post Candidate",
  "description": "Generated content awaiting optimization and scheduling",
  "version": "1.0.0",
  "type": "object",
  "required": [
    "id",
    "created_at",
    "content",
    "features",
    "score",
    "scoring_details",
    "provider",
    "trace_ids",
    "status"
  ],
  "properties": {
    "id": {
      "type": "string",
      "format": "uuid",
      "description": "Unique candidate identifier (UUID v4)"
    },
    "created_at": {
      "type": "string",
      "format": "date-time",
      "description": "Generation timestamp (ISO 8601)"
    },
    "content": {
      "type": "string",
      "maxLength": 280,
      "description": "Post text content"
    },
    "thread_parts": {
      "type": "array",
      "description": "If multi-part thread",
      "items": {
        "type": "string",
        "maxLength": 280
      },
      "maxItems": 25
    },
    "features": {
      "type": "object",
      "description": "Content characteristics",
      "required": ["length", "hashtags", "mentions", "links", "media_type"],
      "properties": {
        "length": {
          "type": "integer",
          "minimum": 1,
          "maximum": 7000,
          "description": "Character count"
        },
        "hashtags": {
          "type": "array",
          "description": "Hashtags used",
          "items": {
            "type": "string",
            "pattern": "^#\\w+"
          }
        },
        "mentions": {
          "type": "array",
          "description": "@mentions",
          "items": {
            "type": "string",
            "pattern": "^@\\w+"
          }
        },
        "links": {
          "type": "array",
          "description": "URLs included",
          "items": {
            "type": "string",
            "format": "uri"
          }
        },
        "media_type": {
          "type": "string",
          "enum": ["image", "video", "none"],
          "description": "Media attachment type"
        }
      }
    },
    "score": {
      "type": "number",
      "minimum": 0.0,
      "maximum": 1.0,
      "description": "Predicted performance (0.0-1.0)"
    },
    "scoring_details": {
      "type": "object",
      "description": "Score breakdown",
      "required": ["perplexity", "style_match", "engagement_prediction"],
      "properties": {
        "perplexity": {
          "type": "number",
          "minimum": 0.0,
          "description": "Language model perplexity"
        },
        "style_match": {
          "type": "number",
          "minimum": 0.0,
          "maximum": 1.0,
          "description": "Style alignment score"
        },
        "engagement_prediction": {
          "type": "number",
          "minimum": 0.0,
          "maximum": 1.0,
          "description": "Predicted engagement"
        }
      }
    },
    "provider": {
      "type": "string",
      "pattern": "^(mlx|dspy)::.+$",
      "description": "LM provider used for generation"
    },
    "trace_ids": {
      "type": "array",
      "description": "Source REER traces used",
      "items": {
        "type": "string",
        "format": "uuid"
      },
      "minItems": 1
    },
    "status": {
      "type": "string",
      "enum": ["draft", "scheduled", "published", "archived"],
      "description": "Candidate status"
    }
  },
  "additionalProperties": false
}